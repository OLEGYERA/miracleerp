<template>
    <div class="mc-content">
        <div class="mc-info mc-mirror">
            <transition name="slide-fade">
                <div v-if="agreement" class="mc-user_license_agreement">
                    <h2 class="mc-title">Пользовательское Соглашение</h2>
                    <div class="agreement-content">
                        Lorem ipsum dolor sit amet, consectetur adipisicing elit. A accusantium alias aspernatur assumenda cupiditate deleniti distinctio dolore, doloribus ea eaque earum et, excepturi explicabo harum id illo iure laborum minima minus nesciunt nihil nobis nulla obcaecati officiis perferendis quaerat saepe sed soluta sunt vero! Dolore ea esse in magnam molestias natus nulla quasi rerum tempora veritatis vero, voluptatum. Ab aliquam aliquid architecto aspernatur, consectetur consequuntur cumque distinctio doloremque enim et eum ex exercitationem hic ipsum iste, itaque iure magni minima minus mollitia nihil nisi nobis nostrum nulla odio officia officiis pariatur placeat praesentium qui quisquam quo repudiandae sed similique tenetur ut voluptas. Ab adipisci alias animi at, beatae blanditiis dolore error ex fuga fugit ipsum itaque laboriosam libero minus non odit pariatur placeat possimus quos reiciendis totam veniam voluptates! Animi asperiores blanditiis eligendi error et, ex facere impedit ipsa nisi non obcaecati odit possimus quia sed sequi suscipit totam unde voluptatum. A accusamus adipisci alias commodi culpa debitis deleniti doloribus illo in, inventore iste nemo nulla officia optio porro quas reprehenderit, totam voluptatibus! Adipisci eligendi hic odit? Enim inventore iste nisi odio, quae quas tenetur. Aliquam amet atque eveniet explicabo ipsum iusto maiores nam praesentium ratione sunt. Accusantium exercitationem quibusdam similique totam. Accusamus, aliquam autem dignissimos dolorum ea et expedita non, odit perspiciatis praesentium quaerat qui, repudiandae voluptatem? Accusamus architecto aut, corporis culpa cumque, distinctio dolores doloribus, excepturi hic inventore laudantium minima provident rerum similique voluptate! A ab aliquam commodi doloremque eligendi eos, eveniet expedita facere facilis fuga fugiat in ipsum iusto laborum porro quasi ratione rem sequi similique soluta suscipit vitae voluptates. A aspernatur assumenda deserunt dolorum error excepturi explicabo fugiat harum hic incidunt, ipsam iste neque non officia, quaerat quos repudiandae ut. Aliquid at dicta dignissimos dolorem ea earum ex expedita id ipsa laborum magnam minima molestiae natus obcaecati officia officiis porro quibusdam, quisquam repellendus saepe sapiente sint soluta, voluptas voluptatem voluptatibus. Assumenda cum dolore doloremque ipsam placeat unde! Ab aspernatur at beatae commodi cumque eius ex fugit impedit in inventore ipsa labore laboriosam libero magnam molestiae nihil nobis nostrum numquam odio optio pariatur provident quae repudiandae, sit soluta sunt tempora unde velit vitae voluptatum. Ab aliquam fugiat laboriosam quia quisquam soluta veritatis voluptas. Aliquam asperiores at cum deleniti dolores excepturi expedita illum itaque laudantium, libero necessitatibus odit officia perferendis quae, reiciendis repellendus unde vel! Ad alias aperiam autem consequuntur cumque debitis dignissimos distinctio eaque earum est et ex expedita explicabo fugiat illo illum inventore, ipsam iure iusto libero maiores maxime molestias mollitia necessitatibus, non nulla numquam officiis provident quae quos recusandae sequi similique sunt tempora tempore unde vero. Architecto debitis deserunt dignissimos distinctio dolor dolore doloremque eligendi eum eveniet excepturi, fugit illum impedit in maiores maxime nam nemo nesciunt non nostrum omnis repellat reprehenderit sint sit, tempore temporibus tenetur vel vitae? Autem consequatur debitis eveniet ex excepturi facere fugiat id, illo, iusto nobis non, obcaecati quod sint! Accusantium adipisci alias amet animi, aperiam at beatae consequuntur cumque cupiditate delectus deleniti deserunt dicta doloremque ducimus eaque earum enim eum ex hic illo impedit ipsa magnam magni minus molestiae nesciunt nobis, officia provident quam, quod recusandae repudiandae suscipit velit veniam voluptate voluptatibus voluptatum? Delectus est explicabo fugit molestias sed vitae! Assumenda culpa magnam nostrum perspiciatis ullam voluptates. A ab atque, beatae commodi consectetur dolor doloribus ducimus esse expedita hic ipsam, minima numquam obcaecati officia praesentium quam quasi quibusdam reiciendis rerum sequi sunt tempora unde veniam? Beatae commodi dolores, expedita fuga ipsa maiores, officiis optio quidem, quis quod ut voluptatum. A adipisci aperiam assumenda beatae debitis deserunt distinctio dolorem eveniet fuga fugit in minus porro, quas recusandae saepe vitae voluptatum. Accusamus amet architecto aspernatur assumenda consequatur consequuntur debitis distinctio dolor dolores eius, error hic illo, labore laudantium libero magni nam nobis nostrum porro quaerat quas quia, saepe sapiente velit veniam? A aut, ea est iste laborum nesciunt possimus praesentium repellendus. Atque dolore earum exercitationem id odio perspiciatis repellendus. Esse in magni, minima odit placeat ratione velit! Commodi deleniti, dolorem dolorum ducimus, eum expedita facilis ipsa iste laboriosam laborum minus neque non officiis quibusdam, quis rem tempora temporibus voluptatem. Adipisci asperiores optio quam sint! Accusantium doloribus facere in magni modi qui sint voluptatibus. Accusamus amet aspernatur atque aut corporis culpa deserunt dignissimos dolore doloribus earum ex fugiat ipsa iusto libero minima, nemo numquam officiis optio pariatur perferendis quaerat quam quia quod soluta temporibus veniam vitae. Aliquam aliquid amet aperiam doloremque dolores explicabo facilis fugiat, itaque nihil nisi quasi qui similique, ut? Asperiores culpa debitis deserunt dolore doloremque earum excepturi itaque laborum libero maxime odio, officiis, ut vel velit vitae! Ad dolore in libero non nostrum officiis, qui quibusdam recusandae unde veritatis? Ad alias aliquid, atque commodi fugiat libero perferendis repellat suscipit voluptates? Deleniti eum inventore iure quidem, quo recusandae veniam! Amet assumenda consequatur deserunt dolores ducimus eaque, obcaecati pariatur porro praesentium reprehenderit. Assumenda atque autem dolor eos excepturi fuga natus nihil, numquam rem soluta sunt ut voluptas. Adipisci eveniet facere hic quaerat, reiciendis sint! Adipisci animi at cumque ea id illo incidunt laboriosam magnam magni maxime molestiae mollitia nam officia pariatur perferendis, possimus quia quibusdam reiciendis reprehenderit rerum sequi similique soluta suscipit ullam vel, vitae voluptas voluptate? Adipisci alias atque blanditiis debitis ex exercitationem impedit incidunt odio quaerat vero. Adipisci animi architecto cumque dolores dolorum, eos qui ratione voluptates. Autem consectetur inventore modi officia quas ratione tempore velit. Architecto aspernatur atque beatae culpa cumque ea fuga impedit iste libero magni modi necessitatibus nisi nostrum quaerat quas quibusdam quis ratione repellat sit unde vitae voluptas, voluptatem voluptatibus! Animi enim illum perspiciatis sapiente tempora. Animi corporis cum deleniti, fugit hic magni molestias nesciunt officia quaerat veniam. Ad facere, facilis ipsum nesciunt repudiandae saepe sequi vel? Accusamus aliquid, animi asperiores dolore explicabo facere iste laborum neque quibusdam quod repellendus sint soluta suscipit? Cupiditate illo incidunt laboriosam optio quibusdam reprehenderit, tempora ullam voluptatibus! Aliquid aspernatur at blanditiis consequatur et ex explicabo iste libero magni, neque nulla officia, quod vitae? Accusantium dignissimos dolor ex odit quod recusandae sint tempore, voluptatem. Alias dolores doloribus libero odio voluptas?
                    </div>
                    <div class="agreement-manage">
                        <button class="mc-btn submit" @click="agreement_submit()">Принять условия</button>
                        <button class="mc-link" @click="agreement = false">Отменить</button>

                    </div>
                </div>
            </transition>
            <div class="mc-backgrounds">
                <div class="mc-bg-els mc-bg-el-1">

                </div>
            </div>
        </div>
        <div class="mc-work mc-mirror" v-bind:class="{ user_license_agreement : agreement}" >
            <div class="center-box">
                <h1 class="mc-title">
                    <img src="img/logo/Logo_img.png" alt="">
                    РЕГИСТРАЦИЯ
                </h1>
                <form @submit.prevent="signin" class="mc-form">
                    <div class="mc-inp-box">
                        <transition name="slide-fade">
                            <div v-if="email_verify == 2" class="mc-inp-error">
                                {{emailError}}
                            </div>
                        </transition>
                        <div class="mc-inp-logo" v-bind:class="{ green : email_verify == 1, red : email_verify == 2}" ><i class="fas fa-envelope"></i></div>
                        <input class="mc-inp" type="email" ref="email" v-model="email" @blur="afterFocusEmail" placeholder="E-mail" required>
                        <div class="mc-inp-helper"><i class="fas fa-info"></i></div>
                    </div>
                    <div class="mc-inp-box">
                        <transition name="slide-fade">
                            <div v-if="password_verify == 2" class="mc-inp-error">
                                {{passwordError}}
                            </div>
                        </transition>
                        <div class="mc-inp-logo" v-bind:class="{ green : password_verify == 1, red : password_verify == 2}"><i class="fas fa-lock"></i></div>
                        <input class="mc-inp" type="password" @blur="afterFocusPassword" v-model="password" placeholder="Пароль" required>
                        <div class="mc-inp-helper"><i class="fas fa-info"></i></div>
                    </div>
                    <div class="mc-inp-box">
                        <transition name="slide-fade">
                            <div v-if="re_password_verify == 2" class="mc-inp-error">
                                Пароли не совпадают.
                            </div>
                        </transition>
                        <div class="mc-inp-logo" v-bind:class="{ green : re_password_verify == 1, red : re_password_verify == 2}"><i class="fas fa-lock-open"></i></div>
                        <input class="mc-inp" type="password" @blur="afterFocusRePassword" v-model="re_password" placeholder="Повторите пароль" required>
                        <div class="mc-inp-helper"><i class="fas fa-info"></i></div>
                    </div>
                    <button class="mc-btn submit sign">Прочесть пользовательское соглашение</button>
                    <div class="mc-inp-box right">
                        <router-link :to="{name: 'login'}" class="mc-ask-accout">Уже есть аккаунт?</router-link>
                    </div>
                </form>
            </div>
        </div>
    </div>
</template>

<script>
    import {HTTP} from '../../../http.js'

    export default {
        mounted() {
            console.log('Component mounted.')
        },
        data: function(){
            return{
                /*data*/
                email: null,
                password: null,
                re_password: null,
                /*conditions*/
                email_verify: 0,
                password_verify: 0,
                re_password_verify: 0,
                pass_equal: false,
                agreement: false,
                /*errors*/
                emailError: null,
                passwordError: null,
            }
        },
        methods: {
            agreement_submit(){
                this.agreement = false;
                HTTP.post(`signin`, {
                    email: this.email,
                    password: this.password,
                })
                    .then(response => {

                    })
                    .catch(error => {

                    })
            },
            signin(){
                if(this.email_verify == 1 && this.password_verify == 1 && this.re_password_verify == 1){
                    this.agreement = true;
                }
                else{
                    this.agreement = false;
                }
            },
            afterFocusEmail(){
                HTTP.post(`verify/email`, {
                    email: this.email
                })
                    .then(response => {
                        this.email_verify = 1;
                    })
                    .catch(error => {
                        this.emailError = error.response.data.errors.email[0];
                        this.email_verify = 2;
                    })
            },
            afterFocusPassword(){
                HTTP.post(`verify/password`, {
                    password: this.password
                })
                    .then(response => {
                        this.password_verify = 1;
                    })
                    .catch(error => {
                        this.passwordError = error.response.data.errors.password[0];
                        this.password_verify = 2;
                    })
            },
            afterFocusRePassword(){
                this.re_password_verify = (this.pass_equal) ? 1 : 2;
            },
        },
        watch: {
            password: function(to, from){
                this.pass_equal = (to == this.re_password) ? true : false;
            },
            re_password: function(to, from){
                this.pass_equal = (to == this.password) ? true : false;
                this.re_password_verify = (this.pass_equal) ? 1 : 0;
            },
        },

    }
</script>
